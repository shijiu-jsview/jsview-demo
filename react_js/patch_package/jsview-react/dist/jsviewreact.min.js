!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],e):e((t=t||self).jsviewreact={},t.React)}(this,function(t,s){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function a(s){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(o,!0).forEach(function(t){var e,i,n;e=s,n=o[i=t],i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(o)):r(o).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(o,t))})}return s}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e){if(null==t)return{};var i,n,s=function(t,e){if(null==t)return{};var i,n,s={},o=Object.keys(t);for(n=0;n<o.length;n++)i=o[n],0<=e.indexOf(i)||(s[i]=t[i]);return s}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)i=o[n],0<=e.indexOf(i)||Object.prototype.propertyIsEnumerable.call(t,i)&&(s[i]=t[i])}return s}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?c(t):e}function p(t,e,i){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(n){var s=Object.getOwnPropertyDescriptor(n,e);return s.get?s.get.call(i):s.value}})(t,e,i||t)}var _;s=s&&s.hasOwnProperty("default")?s.default:s,_="undefined"!=typeof ForgeExtension?Forge:{LogM:console.log.bind(console),LogF:console.error.bind(console),LogE:console.error.bind(console),LogW:console.warn.bind(console),LogI:console.log.bind(console),LogD:console.debug.bind(console),ThrowError:function(t){throw new Error(t)},Assert:function(t){if(!t)throw new Error("ASSERT!!!!!")},BaseActivity:function t(){d(this,t)}};var m=function(){function n(t,e,i){d(this,n),this.PageName=t,this._FocusChild=null,this._LatestFocusChild=null,this.SubPages=[],this._ParentPage=null,this._ConsumeKeycodeUntilUp=-1,this.TouchDispatcher=null,this._Acc=.001,this._KeyLock=!1,this._CVSet=null,this._AutoShow=!1,this._IsShowing=!1,this._HostActivity=i,e&&this.SetContentView(e)}return e(n,[{key:"OnRenderFrame",value:function(){_.LogE("OnRenderFrame() MUST override")}},{key:"OnKeyDown",value:function(){return!1}},{key:"OnKeyUp",value:function(){return!1}},{key:"DispatchKeyDown",value:function(t){if(this._KeyLock)return!0;var e=!1;return(n.LastFocusPage=this)._FocusChild&&(e=this._FocusChild.DispatchKeyDown(t)),e=e||this.OnKeyDown(t)}},{key:"DispatchKeyUp",value:function(t){if(this._KeyLock)return!0;var e=!1;return this._FocusChild&&(e=this._FocusChild.DispatchKeyUp(t)),e=e||this.OnKeyUp(t)}},{key:"PrintLastFocusPage",value:function(){var t="------"+this.PageName+"\n",e=this._ParentPage;return e&&(t+=e.PrintLastFocusPage()),t}},{key:"OnMouseDown",value:function(){return!1}},{key:"EnableTouchDispatcher",value:function(){this.TouchDispatcher=new Forge.TouchDispatcher(this)}},{key:"DisableTouchDispatcher",value:function(){this.TouchDispatcher=null}},{key:"GetTouchView",value:function(){return null}},{key:"GetSwipeParams",value:function(t,e,i){var n=void 0===i||0==i?this._Acc:i,s=t*t/2/n;t<0&&(s=-s);var o=e*e/2/n;return e<0&&(o=-o),{durationX:Math.floor(Math.abs(t/n)),durationY:Math.floor(Math.abs(e/n)),distanceX:s,distanceY:o}}},{key:"OnTouch",value:function(){return!1}},{key:"DispatchTouch",value:function(t){var e=!1;return this.TouchDispatcher&&(e=this.TouchDispatcher.OnTouch(t)),e}},{key:"LostTouchFocus",value:function(){}},{key:"OnJavaKey",value:function(){return!0}},{key:"OnPlatformKey",value:function(){return!0}},{key:"PassPlatformKey",value:function(t,e){if(this._KeyLock)return!1;var i=this.OnPlatformKey(t,e);return i=i&&this.OnJavaKey(t,e)}},{key:"DispatchJavaKey",value:function(t,e){if(t==this._ConsumeKeycodeUntilUp)return 1==e&&(this._ConsumeKeycodeUntilUp=-1),Forge.LogM("Consume Javakey until up keycode="+t+" keyaction="+e),!1;if(this._KeyLock)return!1;-1!=this._ConsumeKeycodeUntilUp&&(Forge.LogE("ERROR: Other key pressed before locked key release"),this._ConsumeKeycodeUntilUp=-1);var i=this._FocusChild,n=!0;return i&&(n=i.DispatchJavaKey(t,e)),n=n&&this.PassPlatformKey(t,e),i!=this._FocusChild&&0==e&&this.CosumeAllKeyUnitlUpForFocusChange(t),n}},{key:"CosumeAllKeyUnitlUpForFocusChange",value:function(t){this._ParentPage?this._ParentPage.CosumeAllKeyUnitlUpForFocusChange(t):this._ConsumeKeycodeUntilUp=t}},{key:"OnHostActivityGetFocus",value:function(){this._ConsumeKeycodeUntilUp=-1}},{key:"IsFocus",value:function(){return!this._ParentPage||this._ParentPage._FocusChild==this}},{key:"_IsLeafInChain",value:function(){return this.IsFocus()&&!this._FocusChild}},{key:"SetParent",value:function(t,e){null!=t?(null!=e&&this.SetContentView(e),t instanceof _.BaseActivity&&(t=t.GetRootPageBase()),(this._ParentPage=t).SubPages.push(this),this._HostActivity=t._HostActivity,t._IsShowing&&this._AutoShow&&this._OnShowInternal()):_.ThrowError("ERROR: parent is null")}},{key:"SetParentPage",value:function(t){this.SetParent(t)}},{key:"RemoveSubPage",value:function(t){t==this._FocusChild&&(this._FocusChild=null),t==this._LatestFocusChild&&(this._LatestFocusChild=null);for(var e=0;e<this.SubPages.length;e++)if(t==this.SubPages[e]){t._OnHideInternal(),this.SubPages.splice(e,1);break}}},{key:"ClearSubPages",value:function(){this.SubPages=[],this._FocusChild=null,this._LatestFocusChild=null}},{key:"GetParentPage",value:function(){return this._ParentPage}},{key:"Focus",value:function(t){if(this.IsFocus()){if(!t)return void _.LogI("Already focused page_name="+this.PageName);if(this._IsLeafInChain())return void _.LogI("Already focused page_name="+this.PageName)}if(this._ParentPage){for(var e,i=[],n=this;n._ParentPage&&!n.IsFocus();)i.push(n),n=n._ParentPage;e=t&&0==i.length?this._FocusChild:i[i.length-1]._ParentPage._FocusChild;for(var s=[];e;)s.push(e),e=e._FocusChild;for(var o=s.length-1;0<=o;o--)s[o]._BlurInternal();for(o=i.length-1;0<=o;o--)i[o]._FocusInternal();if(!t)for(var r=i[0];r._LatestFocusChild&&null==r._FocusChild;)r._LatestFocusChild.Focus(),(r=r._FocusChild)||_.ThrowError("ERROR: focus chain is broken")}}},{key:"_FocusInternal",value:function(){this._ParentPage?((this._ParentPage._FocusChild=this)._ParentPage._LatestFocusChild=this).OnFocus():Forge.LogE("No dispatcher")}},{key:"_BlurInternal",value:function(){this._ParentPage||Forge.LogE("No dispacher"),this._ParentPage._FocusChild==this?(this._ParentPage._FocusChild=null,this.OnBlur()):_.LogW("Not focus yet, page name="+this.PageName)}},{key:"GetFocusChild",value:function(){return this._FocusChild}},{key:"Hide",value:function(){this._AutoShow=!1,this._OnHideInternal()}},{key:"Show",value:function(t){this._OnShowInternal(),t&&this.Focus()}},{key:"OnFocus",value:function(){_.LogW("No overrided Page OnFocus event, page name="+this.PageName)}},{key:"OnBlur",value:function(){_.LogW("No overrided Page OnBlur event, page name="+this.PageName)}},{key:"OnShow",value:function(){_.LogW("No overrided Page OnShow event, page name="+this.PageName)}},{key:"OnHide",value:function(){_.LogW("No overrided Page OnHide event, page name="+this.PageName)}},{key:"_OnShowInternal",value:function(){for(var t,e=0;e<this.SubPages.length;e++)(t=this.SubPages[e])._AutoShow&&t._OnShowInternal();this._IsShowing||(this._IsShowing=!0,this.OnShow())}},{key:"_OnHideInternal",value:function(){for(var t,e=0;e<this.SubPages.length;e++)(t=this.SubPages[e])._IsShowing&&t._OnHideInternal();this._IsShowing&&(this._IsShowing=!1,this.OnHide())}},{key:"GetMainView",value:function(){return null==this._CVSet&&(this._CVSet=new Forge.MainViewSetting(null,null)),this._CVSet}},{key:"GetContentView",value:function(){return null==this._CVSet?null:this._CVSet.View}},{key:"SetContentView",value:function(t){null!=t&&(null!=this._CVSet&&this._CVSet.View.BindedPageBase(null),this._CVSet=new Forge.MainViewSetting(t,null),t.BindedPageBase(this))}},{key:"OnContentViewLostInternal",value:function(){this.OnContentViewLost()}},{key:"OnContentViewLost",value:function(){}},{key:"GetHostActivity",value:function(){return this._HostActivity}},{key:"SetHostActivity",value:function(t){this._HostActivity=t}},{key:"GetTextureManager",value:function(){return null!=this._HostActivity?this._HostActivity.GetTextureManager():null}},{key:"SetAutoShow",value:function(t){this._AutoShow=t}},{key:"KeyLock",value:function(){this._KeyLock=!0}},{key:"UnKeyLock",value:function(){this._KeyLock=!1}}]),n}();m.LastFocusPage=null;var y,b,v,I,S,x=(y=Object,b=y.getPrototypeOf||function(t){return t.__proto__},v=y.setPrototypeOf||function(t,e){return t.__proto__=e,t},I="object"===("undefined"==typeof Reflect?"undefined":i(Reflect))?Reflect.construct:function(t,e,i){var n,s=[null];return s.push.apply(s,e),n=t.bind.apply(t,s),v(new n,i.prototype)},function(t){var e=b(t);return v(t,v(function(){return I(e,arguments,b(this).constructor)},e))}),F=function(){function t(){d(this,t),this._ChildMap=new Map}return e(t,[{key:"add",value:function(t,e){this._ChildMap.set(t,e)}},{key:"focus",value:function(t){var e=this._ChildMap.get(t);return!!e&&(e.Focus(),!0)}},{key:"forEach",value:function(t){this._ChildMap.forEach(t)}}]),t}();S="undefined"!=typeof ForgeExtension?Forge.PageBase:m;var k=x(function(){function n(t){var e;return d(this,n),(e=f(this,g(n).call(this,t)))._OnKeyDown=null,e._OnKeyUp=null,e._OnFocus=null,e._OnBlur=null,e._DispatchKeyDown=null,e._DispatchKeyUp=null,e._Mounted=!1,e.BranchName=null,e.Router=null,e._TmpRouter=null,e._SubNodes=e.SubPages,e._AutoShow=!1,e}return l(n,S),e(n,[{key:"UpdateMountState",value:function(){for(var t in this._Mounted=!0,this._SubNodes)this._SubNodes[t].UpdateMountState()}},{key:"SetRouter",value:function(t){this.Router=t}},{key:"RouterAdd",value:function(t,e){this.Router?this.Router.add(t,e):this._ParentPage?this._ParentPage.RouterAdd(t,e):(this._TmpRouter||(this._TmpRouter=new F),this._TmpRouter.add(t,e))}},{key:"SetBranchName",value:function(t){this.BranchName=t}},{key:"SetOnKeyDown",value:function(t){this._OnKeyDown=t}},{key:"SetOnKeyUp",value:function(t){this._OnKeyUp=t}},{key:"SetOnFocus",value:function(t){this._OnFocus=t}},{key:"SetOnBlur",value:function(t){this._OnBlur=t}},{key:"SetDispatchKeyUp",value:function(t){this._DispatchKeyUp=t}},{key:"SetDispatchKeyDown",value:function(t){this._DispatchKeyDown=t}},{key:"OnKeyDown",value:function(t){return!!this._OnKeyDown&&this._OnKeyDown(t)}},{key:"OnKeyUp",value:function(t){return!!this._OnKeyUp&&this._OnKeyUp(t)}},{key:"OnKeyUp",value:function(t){return!!this._OnKeyUp&&this._OnKeyUp(t)}},{key:"DispatchKeyDown",value:function(t){var e=!1;return this._DispatchKeyDown&&(e=this._DispatchKeyDown(t)),!!e||p(g(n.prototype),"DispatchKeyDown",this).call(this,t)}},{key:"DispatchKeyUp",value:function(t){var e=!1;return this._DispatchKeyUp&&(e=this._DispatchKeyUp(t)),!!e||p(g(n.prototype),"DispatchKeyUp",this).call(this,t)}},{key:"AttachToActivity",value:function(t,e){p(g(n.prototype),"SetParent",this).call(this,t,e)}},{key:"SetParent",value:function(t){var i=this;null!=t&&(p(g(n.prototype),"SetParent",this).call(this,t,null),this._ParentPage._Mounted&&(this.UpdateMountState(),n.CurFocus&&n.CurFocus.Focus()),this._TmpRouter&&(this._TmpRouter.forEach(function(t,e){i._ParentPage.RouterAdd(e,t)}),this._TmpRouter=null),this.BranchName&&(console.log("add router "+this.BranchName),this._ParentPage.RouterAdd(this.BranchName,this)))}},{key:"Focus",value:function(t){this._Mounted?p(g(n.prototype),"Focus",this).call(this,t):n.CurFocus=this}},{key:"OnFocus",value:function(){this._OnFocus&&this._OnFocus()}},{key:"OnBlur",value:function(){this._OnBlur&&this._OnBlur()}}]),n}());k.CurFocus,k.LastFocusNode=null,k.RootPageNode=null;function L(t){var e=""+P++;return A.set(e,t),e}function w(t){A.delete(t)}function E(t){return A.get(t)}var P=0,A=new Map;k.pbMap=A;var O=function(){function c(t){var e;d(this,c);var i=(e=f(this,g(c).call(this,t))).props.onKeyUp,n=e.props.onKeyDown,s=e.props.onFocus,o=e.props.onBlur,r=e.props.dispathchKeyDown,a=e.props.dispathcKeyUp,l=e.props.branchName,h=e.props.router,u=new k(e.props.id);return l&&u.SetBranchName(l),n&&u.SetOnKeyDown(n),i&&u.SetOnKeyUp(i),s&&u.SetOnFocus(s),o&&u.SetOnBlur(o),r&&u.SetDispatchKeyDown(r),a&&u.SetDispatchKeyUp(a),h&&u.SetRouter(h),e._FocusNodeId=L(u),e}return l(c,s.Component),e(c,[{key:"render",value:function(){var e=this,t=this.props,i=(t.onKeyDown,t.onKeyUp,t.onFocus,t.onBlur,t.dispathchKeyDown,t.dispathcKeyUp,t.focus,t.branchName,t.router,u(t,["onKeyDown","onKeyUp","onFocus","onBlur","dispathchKeyDown","dispathcKeyUp","focus","branchName","router"]));return s.createElement("div",o({ref:function(t){e._Element=t}},i,{__pbid:this._FocusNodeId}))}},{key:"componentDidMount",value:function(){for(var t=E(this._FocusNodeId),e=this._Element;e.parentElement;){var i=(e=e.parentElement).getAttribute("__pbid");if(i){var n=E(i);t.SetParent(n);break}}}},{key:"componentWillUnmount",value:function(){console.log(this.props.id+"unmount"),this._Element.setAttribute("__pbid",""),this._Element=null,E(this._FocusNodeId).ClearSubPages(),w(this._FocusNodeId)}}]),c}(),N=function(){function n(t){var e;d(this,n),e=f(this,g(n).call(this,t));var i=new k("root");return e._FocusNodeId=L(i),function(t){k.RootPageBase=t}(i),"undefined"!=typeof ForgeExtension?i.AttachToActivity(ForgeExtension.RootActivity,ForgeExtension.RootView):(window.addEventListener("keydown",function(t){E(e._FocusNodeId).DispatchKeyDown(t)}),window.addEventListener("keyup",function(t){E(e._FocusNodeId).DispatchKeyUp(t)})),e}return l(n,s.Component),e(n,[{key:"render",value:function(){return s.createElement("div",o({__pbid:this._FocusNodeId},this.props))}},{key:"componentDidMount",value:function(){console.log("Root didmount"),E(this._FocusNodeId).UpdateMountState(),k.CurFocus&&k.CurFocus.Focus()}},{key:"componentWillUnmount",value:function(){console.log("Root unmount"),E(this._FocusNodeId).ClearSubPages(),w(this._FocusNodeId)}}]),n}(),R=function(){function i(t,e){d(this,i),this.Ranges=[],void 0!==t&&void 0!==e&&this.Ranges.push(new Forge.SingleRangeModel(t,e))}return e(i,[{key:"Merge",value:function(t){for(var e=!1,i=this.Ranges.length,n=0;n<this.Ranges.length;n++){if(t.End+1<this.Ranges[n].Start){i=n;break}if(this.Ranges[n].Merge(t)){for(e=!0;n+1<this.Ranges.length&&this.Ranges[n].Merge(this.Ranges[n+1]);)this.Ranges.splice(n+1,1);break}}e||this.Ranges.splice(i,0,t)}},{key:"Exclude",value:function(t){for(var e=0;e<this.Ranges.length&&!(t.End<this.Ranges[e].Start);e++){var i=this.Ranges[e].Exclude(t);if(this.Ranges[e].IsEmpty()&&(this.Ranges.splice(e,1),e--),null!=i.newSplitedRange){this.Ranges.splice(e+1,0,i.newSplitedRange);break}}}},{key:"ForEach",value:function(t,e){if(t)if(e)for(var i=this.Ranges.length-1;0<=i;i--)for(var n=this.Ranges[i].End;n>=this.Ranges[i].Start;n--)t(n);else for(i=0;i<this.Ranges.length;i++)for(n=this.Ranges[i].Start;n<=this.Ranges[i].End;n++)t(n);else Forge.ThrowError("Callback function is invalid")}}]),i}(),C=function(){function i(t,e){d(this,i),this.Start=t,this.End=e}return e(i,[{key:"Merge",value:function(t){return this.IsInterAct(t)?(this.Start>t.Start&&(this.Start=t.Start),this.End<t.End&&(this.End=t.End),!0):this.End+1==t.Start?(this.End=t.End,!0):this.Start==t.End+1&&(this.Start=t.Start,!0)}},{key:"IsInterAct",value:function(t){return t.Start<this.Start?!(t.End<this.Start):t.Start<=this.End}},{key:"Exclude",value:function(t){var e={success:!1,newSplitedRange:null};return this.IsInterAct(t)&&(t.Start<=this.Start?t.End<this.End?this.Start=t.End+1:this.Clear():(t.End<this.End&&(e.newSplitedRange=new Forge.SingleRangeModel(t.End+1,this.End),e.newSplitedRange=e.newSplitedRange),this.End=t.Start-1),e.success=!0,e.success=e.success),e}},{key:"IsEmpty",value:function(){return this.Start>this.End}},{key:"Clear",value:function(){this.End=this.Start-1}},{key:"Clone",value:function(){return new i(this.Start,this.End)}}]),i}(),T=function(){function s(t,e,i,n){d(this,s),this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0,("number"!=typeof i||i<0)&&(i=0),this.width=i,("number"!=typeof n||n<0)&&(n=0),this.height=n}return e(s,[{key:"Equals",value:function(t){return null!=t&&(t.x==this.x&&t.y==this.y&&t.width==this.width&&t.height==this.height)}}]),s}(),M=(new(function(){function t(){d(this,t)}return e(t,[{key:"FormatRectArea",value:function(t){var e=null;if(t instanceof T)e=t;else if("object"==i(t)&&null!=t){if(isNaN(t.width)||isNaN(t.height))throw Error("ERROR: target_size format should be {width:XXXX, height:XXXX}");e=new T(0,0,t.width,t.height)}return e}}]),t}()),function(){function n(t,e,i){d(this,n),this.IdsMap=[],this._IdsTotal=-1,this.List=[],this.Orient={type:t,widthMax:e},this.Layout={type:i||"relative"}}return e(n,[{key:"SetIdsMap",value:function(t,e){this.IdsMap[t]=e,this._IdsTotal=-1,this.List[e].id=t}},{key:"AddItem",value:function(t){this.List.push(t)}},{key:"GetIdsTotal",value:function(){if(this._IdsTotal<0){for(var t=0,e=0;e<this.List.length;e++)0<=this.List[e].id&&t++;this._IdsTotal=t}return this._IdsTotal}}]),n}());M.getTemplateItem=function(t,e){return{id:-1,itemFocusable:!!t.itemFocusable,xPos:t.blocks.x?t.blocks.x:0,yPos:t.blocks.y?t.blocks.y:0,centerXPos:0,centerYPos:0,width:t.blocks.w,height:t.blocks.h,focusAble:t.focusable,needRedraw:void 0===t.needRedraw||t.needRedraw,onBottomLine:!1,view:null,data:e}};function V(){}function U(){return null}var D=function(){function s(t,e,i,n){d(this,s),this._Gaps=[{GapStart:0,GapEnd:i-1}],this._FenceTotalWidth=i,this.AheadOffset=n,0<e&&this._SplitGap(0,t,e)}return e(s,[{key:"HasGapFor",value:function(t){for(var e=0;e<this._Gaps.length;e++)if(this._Gaps[e].GapEnd-this._Gaps[e].GapStart+1>=t)return{startPos:this._Gaps[e].GapStart};return null}},{key:"MarkGapUsed",value:function(t,e){if(e<=0)return this._Gaps.length;for(var i=t+e-1,n=-1,s=0;s<this._Gaps.length;s++)if(this._Gaps[s].GapStart<=t&&this._Gaps[s].GapEnd>=i){n=s;break}return-1==n&&console.log("Error in mark gap used, not found suitable gap of offset="+this.AheadOffset),this._SplitGap(n,t,e),this._Gaps.length}},{key:"_SplitGap",value:function(t,e,i){var n=this._Gaps.splice(t,1)[0],s=e+i-1;(e<n.GapStart||s>n.GapEnd)&&console.log("ERROR in split Fence Gap, range overflow"),s!=n.GapEnd&&this._Gaps.splice(t,0,{GapStart:1+s,GapEnd:n.GapEnd}),e!=n.GapStart&&this._Gaps.splice(t,0,{GapStart:n.GapStart,GapEnd:e-1})}},{key:"Fork",value:function(t){var e=new s(0,0,0,0);return e._Gaps=JSON.parse(JSON.stringify(this._Gaps)),e._FenceTotalWidth=this._FenceTotalWidth,e.AheadOffset=t,e}}]),s}(),B=function(){function o(t,e,i,n,s){d(this,o),this._Template=new M(t,e,i),this._FenceStack=[new D(0,0,this._Template.Orient.widthMax,0)],this._Identity=0,this._MoveLimitArea=new T(0,0,n,s),this._FenceEdge={StartX:0,StartY:0},this._NotOccupiedEdgeList=[],this._SupportHistoryPath=!1,this._VisibleRangeSearchBaseItem=null}return e(o,[{key:"_CheckNeighborItemMatching",value:function(t,e,i){var n=!1,s=e.edgeObj,o=i.edgeObj,r="rightEdge",a="leftEdge";switch(t){case"left":r="rightEdge",a="leftEdge";break;case"right":r="leftEdge",a="rightEdge";break;case"top":r="bottomEdge",a="topEdge";break;case"bottom":a="bottomEdge",r="topEdge"}n=!1;var l=o[r].range.Start,h=o[r].range.Clone();o[r].range.Exclude(s[a].range),s[a].range.Exclude(h);var u=o[r].range.Start;return o[r].range.IsEmpty()&&(n=!(o[r]=null)),s[a].range.IsEmpty()&&(n=!(s[a]=null)),l!=u&&(n=!0),n}},{key:"_FindNearestNeighbor",value:function(t){for(var e=t.edgeObj,i=-1,n=-1,s=-1,o=-1,r=-1,a=-1,l=-1,h=-1,u=0;u<this._NotOccupiedEdgeList.length;u++){var c=this._NotOccupiedEdgeList[u],d=c.edgeObj;if(t!=c){if(null!=e.leftEdge&&null!=d.rightEdge&&e.leftEdge.x>=d.rightEdge.x&&e.leftEdge.range.IsInterAct(d.rightEdge.range)){if(-1==r){r=e.leftEdge.x-d.rightEdge.x,i=u;continue}if(r>e.leftEdge.x-d.rightEdge.x){r=e.leftEdge.x-d.rightEdge.x,i=u;continue}}if(null!=e.rightEdge&&null!=d.leftEdge&&e.rightEdge.x<=d.leftEdge.x&&e.rightEdge.range.IsInterAct(d.leftEdge.range)){if(-1==a){a=d.leftEdge.x-e.rightEdge.x,n=u;continue}if(a>d.leftEdge.x-e.rightEdge.x){a=d.leftEdge.x-e.rightEdge.x,n=u;continue}}if(null!=e.topEdge&&null!=d.bottomEdge&&e.topEdge.y>=d.bottomEdge.y&&e.topEdge.range.IsInterAct(d.bottomEdge.range)){if(-1==l){l=e.topEdge.y-d.bottomEdge.y,s=u;continue}if(l>e.topEdge.y-d.bottomEdge.y){l=e.topEdge.y-d.bottomEdge.y,s=u;continue}}if(null!=e.bottomEdge&&null!=d.topEdge&&e.bottomEdge.y<=d.topEdge.y&&e.bottomEdge.range.IsInterAct(d.topEdge.range)){if(-1==h){h=d.topEdge.y-e.bottomEdge.y,o=u;continue}if(h>d.topEdge.y-e.bottomEdge.y){h=d.topEdge.y-e.bottomEdge.y,o=u;continue}}}}return{left:i,right:n,top:s,bottom:o}}},{key:"_CalculateNeighborItem",value:function(t){for(var e=this._Template.List,i=0;i<this._NotOccupiedEdgeList.length;i++){var n=this._NotOccupiedEdgeList[i],s=n.edgeObj,o=n.index;if(this._Template.Orient.type==G){if(null==s.bottomEdge){this._NotOccupiedEdgeList.splice(i,1),i--;continue}if(!t&&s.bottomEdge.y>this._FenceEdge.StartY)continue}else{if(null==s.rightEdge){this._NotOccupiedEdgeList.splice(i,1),i--;continue}if(!t&&s.rightEdge.x>this._FenceEdge.StartX)continue}var r=this._FindNearestNeighbor(n);if(-1!=r.left){var a=(l=this._NotOccupiedEdgeList[r.left]).index;if(t)e[a].tmpNeighborIndexList.right.push(o),e[o].tmpNeighborIndexList.left.push(a);else this._CheckNeighborItemMatching("left",n,l)&&(e[a].neighborIndexList.right.push(o),e[o].neighborIndexList.left.push(a),e[a].tmpNeighborIndexList.right=[],e[o].tmpNeighborIndexList.left=[])}if(-1!=r.right){a=(l=this._NotOccupiedEdgeList[r.right]).index;if(t)e[a].tmpNeighborIndexList.left.push(o),e[o].tmpNeighborIndexList.right.push(a);else this._CheckNeighborItemMatching("right",n,l)&&(e[a].neighborIndexList.left.push(o),e[o].neighborIndexList.right.push(a),e[a].tmpNeighborIndexList.left=[],e[o].tmpNeighborIndexList.right=[])}if(-1!=r.top){a=(l=this._NotOccupiedEdgeList[r.top]).index;if(t)e[a].tmpNeighborIndexList.bottom.push(o),e[o].tmpNeighborIndexList.top.push(a);else this._CheckNeighborItemMatching("top",n,l)&&(e[a].neighborIndexList.bottom.push(o),e[o].neighborIndexList.top.push(a),e[a].tmpNeighborIndexList.bottom=[],e[o].tmpNeighborIndexList.top=[])}if(-1!=r.bottom){var l;a=(l=this._NotOccupiedEdgeList[r.bottom]).index;if(t)e[a].tmpNeighborIndexList.top.push(o),e[o].tmpNeighborIndexList.bottom.push(a);else this._CheckNeighborItemMatching("bottom",n,l)&&(e[a].neighborIndexList.top.push(o),e[o].neighborIndexList.bottom.push(a),e[a].tmpNeighborIndexList.top=[],e[o].tmpNeighborIndexList.bottom=[])}}}},{key:"_TryCalculateNeighborItem",value:function(t,e,i,n,s){var o={index:t,edgeObj:{leftEdge:{x:e,range:new C(i,i+s-1)},rightEdge:{x:e+n,range:new C(i,i+s-1)},topEdge:{y:i,range:new C(e,e+n-1)},bottomEdge:{y:i+s,range:new C(e,e+n-1)}}};0==e&&(o.edgeObj.leftEdge=null),0==i&&(o.edgeObj.topEdge=null);var r=!1,a=this._Template.Orient.widthMax,l=this._FenceEdge.StartX,h=this._FenceEdge.StartY;this._Template.Orient.type==G?(e+n==a&&(o.edgeObj.rightEdge=null),i>this._FenceEdge.StartY&&(r=!0,h=i)):(i+s==a&&(o.edgeObj.bottomEdge=null),e>this._FenceEdge.StartX&&(r=!0,l=e)),this._FenceEdge.StartX=l,this._FenceEdge.StartY=h,this._NotOccupiedEdgeList.push(o),r&&this._CalculateNeighborItem()}},{key:"_UpdateLastFenceEdge",value:function(){for(var t=this._FenceEdge,e={StartX:-1,StartY:-1},i=0;i<this._NotOccupiedEdgeList.length;i++){var n=this._NotOccupiedEdgeList[i].edgeObj;this._Template.Orient.type==G?null!=n.bottomEdge&&n.bottomEdge.y>t.StartY&&(-1==e.StartY?e.StartY=n.bottomEdge.y:n.bottomEdge.y<e.StartY&&(e.StartY=n.bottomEdge.y)):null!=n.rightEdge&&n.rightEdge.x>t.StartX&&(-1==e.StartX?e.StartX=n.rightEdge.x:n.rightEdge.y<e.StartX&&(e.StartX=n.rightEdge.x))}this._FenceEdge=e}},{key:"ParseTemplateItem",value:function(t,e){var i,n,s,o,r=M.getTemplateItem(t,e),a=this._FenceStack,l=-1,h=1,u=r.id,c=r.width,d=r.height,p=0;if("relative"==this._Template.Layout.type){for(var g=this._Template.Orient.type==G?c:d,f=this._Template.Orient.type==G?d:c,_=0,m=0,y=null,b=null;0<a.length;){var v=a[a.length-1];if(null!=(b=v.HasGapFor(g))){y=v;break}a.pop()}null!=b?(_=b.startPos,m=y.AheadOffset):console.log("ERROR: coding error, header full gap fence lost"),p=this._Template.Orient.type==G?(i=_,s=g,((n=m)+(o=f))/this._MoveLimitArea.height):(n=_,o=g,((i=m)+(s=f))/this._MoveLimitArea.width)}else i=r.xPos,n=r.yPos,s=c,o=d,p=this._Template.Orient.type==G?(n+o)/this._MoveLimitArea.height:(i+s)/this._MoveLimitArea.width;-1==l&&(l=u);var I=Math.ceil(p);0<=p&&I!=h&&(h=I,l=u),r.curPageHeadId=l,r.neighborIndexList={left:[],top:[],right:[],bottom:[]},r.tmpNeighborIndexList={left:[],top:[],right:[],bottom:[]},r.pathHistory={left:null,top:null,right:null,bottom:null},r.xPos=i,r.yPos=n,r.centerXPos=Math.floor(i+s/2)-1,r.centerYPos=Math.floor(n+o/2)-1,this._Template.Orient.type!=G&&n+o==this._Template.Orient.widthMax&&(r.onBottomLine=!0),this._Template.AddItem(r),r.focusAble&&this._Template.SetIdsMap(this._Identity++,this._Template.List.length-1),this._TryCalculateNeighborItem(this._Template.List.length-1,r.xPos,r.yPos,r.width,r.height);var S=m+f-1;a[0].AheadOffset<=S&&a.splice(0,0,new D(0,0,this._Template.Orient.widthMax,1+S));for(var x=!1,F=!1,k=-1,L=a.length-1;0<=L;L--){if(!(a[L].AheadOffset<=S)){a[L].AheadOffset==1+S&&(F=!0),k=L;break}a[L].AheadOffset==S&&(x=!0),0==a[L].MarkGapUsed(_,g)&&a.splice(L,1)}var w=S;if(!x&&k+1<=a.length-1){var E=a[k+1].Fork(w);a.splice(k+1,0,E)}if(!F&&0<k){E=a[k].Fork(1+w);a.splice(k+1,0,E)}}},{key:"GetItem",value:function(t){return this._Template.List[this._Template.IdsMap[t]]}},{key:"_CheckIdsHasFocusable",value:function(t){for(var e=this._Template.List,i=!1,n=0;n<t.length;n++){if(e[t[n]].focusAble){i=!0;break}}return i}},{key:"_IsInNeighborList",value:function(t,e){for(var i=!1,n=t.length-1;0<=n;n--)if(t[n]==e){i=!0;break}return i}},{key:"_GetValidNeighborIndex",value:function(t,e,i){var n=this._Template.List,s=-1,o=n[e],r=n[t],a=null,l=null;if(0<(a="top"==i?(l=o.neighborIndexList.left,o.neighborIndexList.right):(l=o.neighborIndexList.right,o.neighborIndexList.left)).length)for(var h=0;h<a.length;h++){if((c=n[u=a[h]]).focusAble&&("top"==i&&c.yPos+c.height<=r.yPos||"bottom"==i&&c.yPos>=r.yPos+r.height)){s=u;break}}if(-1==s&&0<l.length)for(h=0;h<l.length;h++){var u,c;if((c=n[u=l[h]]).focusAble&&("top"==i&&c.yPos+c.height<=r.yPos||"bottom"==i&&c.yPos>=r.yPos+r.height)){s=u;break}}return s}},{key:"_CaculateNeighborItem",value:function(t){for(var e=this._Template.List,i=0;i<this._NotOccupiedEdgeList.length;i++){var n=this._NotOccupiedEdgeList[i],s=n.edgeObj,o=n.index;if(this._Template.Orient.type==G){if(null==s.bottomEdge){this._NotOccupiedEdgeList.splice(i,1),i--;continue}if(!t&&s.bottomEdge.y>this._FenceEdge.StartY)continue}else{if(null==s.rightEdge){this._NotOccupiedEdgeList.splice(i,1),i--;continue}if(!t&&s.rightEdge.x>this._FenceEdge.StartX)continue}var r=this._FindNearestNeighbor(n);if(-1!=r.left){var a=(l=this._NotOccupiedEdgeList[r.left]).index;if(t)e[a].tmpNeighborIndexList.right.push(o),e[o].tmpNeighborIndexList.left.push(a);else this._CheckNeighborItemMatching("left",n,l)&&(e[a].neighborIndexList.right.push(o),e[o].neighborIndexList.left.push(a),e[a].tmpNeighborIndexList.right=[],e[o].tmpNeighborIndexList.left=[])}if(-1!=r.right){a=(l=this._NotOccupiedEdgeList[r.right]).index;if(t)e[a].tmpNeighborIndexList.left.push(o),e[o].tmpNeighborIndexList.right.push(a);else this._CheckNeighborItemMatching("right",n,l)&&(e[a].neighborIndexList.left.push(o),e[o].neighborIndexList.right.push(a),e[a].tmpNeighborIndexList.left=[],e[o].tmpNeighborIndexList.right=[])}if(-1!=r.top){a=(l=this._NotOccupiedEdgeList[r.top]).index;if(t)e[a].tmpNeighborIndexList.bottom.push(o),e[o].tmpNeighborIndexList.top.push(a);else this._CheckNeighborItemMatching("top",n,l)&&(e[a].neighborIndexList.bottom.push(o),e[o].neighborIndexList.top.push(a),e[a].tmpNeighborIndexList.bottom=[],e[o].tmpNeighborIndexList.top=[])}if(-1!=r.bottom){var l;a=(l=this._NotOccupiedEdgeList[r.bottom]).index;if(t)e[a].tmpNeighborIndexList.top.push(o),e[o].tmpNeighborIndexList.bottom.push(a);else this._CheckNeighborItemMatching("bottom",n,l)&&(e[a].neighborIndexList.top.push(o),e[o].neighborIndexList.bottom.push(a),e[a].tmpNeighborIndexList.top=[],e[o].tmpNeighborIndexList.bottom=[])}}}},{key:"CalculateNeighborWhenAddStop",value:function(){this._UpdateLastFenceEdge(),this._CaculateNeighborItem();this._CaculateNeighborItem(!0);for(var t=this._Template.List,e=t.length-1,i=t[e],n=t.length-1;0<=n;n--)if((i=t[n]).focusAble){e=n;break}for(var s=t.length-1;0<=s;s--){var o=t[s];if(o.focusAble){if(0<o.neighborIndexList.bottom.length&&!this._CheckIdsHasFocusable(o.neighborIndexList.bottom)){var r=o.neighborIndexList.bottom[o.neighborIndexList.bottom.length-1],a=this._GetValidNeighborIndex(s,r,"bottom");-1!=a&&(o.neighborIndexList.bottom=[],o.neighborIndexList.bottom.push(a))}if(0<o.neighborIndexList.top.length&&!this._CheckIdsHasFocusable(o.neighborIndexList.top)){var l=this._GetValidNeighborIndex(s,o.neighborIndexList.top[o.neighborIndexList.top.length-1],"top");-1!=l&&(o.neighborIndexList.top=[],o.neighborIndexList.top.push(l))}}}if(this._Template.Orient.type!=G){for(var h=null,u=-1,c=0,d=(this._Template.Orient.widthMax,e-1);0<=d;d--){var p=t[d];p.focusAble&&p.yPos>=i.yPos+i.height&&(0!=p.neighborIndexList.right.length&&this._CheckIdsHasFocusable(p.neighborIndexList.right)&&!this._IsInNeighborList(p.neighborIndexList.right,e)||(c=Math.pow(i.xPos-p.xPos,2)+Math.pow(i.yPos-p.yPos,2),-1==u?(u=c,h=d):c<u&&(u=c,h=d)))}h&&(i.neighborIndexList.bottom=[],i.neighborIndexList.bottom.push(h))}else for(d=e-1;0<=d;d--){var g=t[d];g.focusAble&&g.yPos+g.height<i.yPos+i.height&&0==g.neighborIndexList.bottom.length&&g.neighborIndexList.bottom.push(e)}}},{key:"GetNextItem",value:function(t,e,i,n){0==e&&0==i&&console.log("GetNextItem(): offset is 0"),0!=e&&0!=i&&console.log("GetNextItem(): not support change vertical and horizontal and the same time");var s,o=this._Template.IdsMap[t];return s=0!=e?this._GetNextItemVertical(o,e):this._GetNextItemHorizontal(o,i),n&&null==s&&(s=0!=e?this._GetNextLoopItemVertical(o,e):this._GetNextLoopItemHorizontal(o,i)),null==s?-1:s.id}},{key:"_GetNextItemVertical",value:function(t,e){var i=this._Template.List,n=i[t].centerXPos,s="top",o="bottom";0<e&&(o="top",s="bottom");for(var r=i.length-1,a=this._Template.Orient.type,l=i.length-1;0<=l;l--){if(i[l].focusAble){r=l;break}}var h=!1,u=-1,c=null;if(this._SupportHistoryPath&&(c=i[t].pathHistory[s]),null==c){var d=i[t].neighborIndexList[s];if(0<i[t].tmpNeighborIndexList[s].length&&(d=d.concat(i[t].tmpNeighborIndexList[s])),1==d.length)u=d[0],r==t&&"bottom"==s&&a==K||(i[t].pathHistory[s]=u,i[u].pathHistory[o]=t),h=!0;else{for(l=0;l<d.length;l++){if(n<=(p=i[u=d[l]]).xPos+p.width-1&&n>=p.xPos){r==t&&"bottom"==s&&a==K||(i[t].pathHistory[s]=u,i[u].pathHistory[o]=t),h=!0;break}}if(!h||!i[u].focusAble)for(l=0;l<d.length;l++){var p,g=d[l];if((p=i[g]).focusAble){r==t&&"bottom"==s&&a==K||(i[t].pathHistory[s]=u,i[u].pathHistory[o]=t),u=g,h=!0;break}}}}else u=c,r==t&&"bottom"==s&&a==K||(i[u].pathHistory[o]=t),h=!0;return h?i[u].focusAble?i[u]:this._GetNextItemVertical(u,e):null}},{key:"_GetNextItemHorizontal",value:function(t,e){var i=this._Template.List,n=i[t].centerYPos,s="left",o="right";0<e&&(o="left",s="right");for(var r=i.length-1,a=this._Template.Orient.type,l=i.length-1;0<=l;l--){if(i[l].focusAble){r=l;break}}var h=!1,u=-1,c=null;if(this._SupportHistoryPath&&(c=i[t].pathHistory[s]),null==c){var d=i[t].neighborIndexList[s];if(0<i[t].tmpNeighborIndexList[s].length&&(d=d.concat(i[t].tmpNeighborIndexList[s])),1==d.length)u=d[0],r==t&&"right"==s&&a==G||(i[t].pathHistory[s]=u,i[u].pathHistory[o]=t),h=!0;else{for(l=0;l<d.length;l++){if(n<=(p=i[u=d[l]]).yPos+p.height-1&&n>=p.yPos){r==t&&"right"==s&&a==G||(i[t].pathHistory[s]=u,i[u].pathHistory[o]=t),h=!0;break}}if(!h||!i[u].focusAble)for(l=0;l<d.length;l++){var p,g=d[l];if((p=i[g]).focusAble){r==t&&"right"==s&&a==G||(i[t].pathHistory[s]=u,i[u].pathHistory[o]=t),u=g,h=!0;break}}}}else u=c,r==t&&"right"==s&&a==G||(i[u].pathHistory[o]=t),h=!0;return h?i[u].focusAble?i[u]:this._GetNextItemHorizontal(u,e):null}},{key:"_GetNextLoopItemVertical",value:function(t,e){var i=this._Template.List,n=i[t].centerXPos,s="bottom";0<e&&(s="top");var o=!1,r=-1,a=i[t].neighborIndexList[s];for(0<i[t].tmpNeighborIndexList[s].length&&(a=a.concat(i[t].tmpNeighborIndexList[s]));1<=a.length;)for(var l=0;l<a.length;l++){var h=i[r=a[l]];if(n<=h.xPos+h.width-1&&n>=h.xPos){a=i[r].neighborIndexList[s],o=!0;break}}return o?i[r].focusAble?i[r]:this._GetNextLoopItemVertical(r,e):null}},{key:"_GetNextLoopItemHorizontal",value:function(t,e){var i=this._Template.List,n=i[t].centerYPos,s="right";0<e&&(s="left");var o=!1,r=-1,a=i[t].neighborIndexList[s];for(0<i[t].tmpNeighborIndexList[s].length&&(a=a.concat(i[t].tmpNeighborIndexList[s]));1<=a.length;)for(var l=0;l<a.length;l++){var h=i[r=a[l]];if(n<=h.yPos+h.height-1&&n>=h.yPos){a=i[r].neighborIndexList[s],o=!0;break}}return o?i[r].focusAble?i[r]:this._GetNextLoopItemHorizontal(r,e):null}},{key:"GetTemplate",value:function(){return this._Template}},{key:"GetVisibleItemList",value:function(t,e,i){if(e<t)return null;for(var n=this._Template.IdsMap[i],s={resultStartIdx:-1,resultEndIdx:-1,enableBackwardSearching:!0,enableForwardSearching:!0,checkingStartLinePos:t,checkingEndLinePos:e},o={searchDirect:-1,baseIdx:n,checkingStartLineRanges:new R,startLineRangesFulled:!1,latestOverStartLineIdx:-1,checkingEndLineRanges:new R,endLineRangesFulled:!1,latestOverEndLineIdx:-1,endSearchingIndex:0,firstStartLineBlockIdx:-1,firstEndLineBlockIdx:-1,searchToBorder:!1,common:s},r={searchDirect:1,baseIdx:n,checkingStartLineRanges:new R,startLineRangesFulled:!1,latestOverStartLineIdx:-1,checkingEndLineRanges:new R,endLineRangesFulled:!1,latestOverEndLineIdx:-1,endSearchingIndex:this._Template.List.length-1,firstStartLineBlockIdx:-1,firstEndLineBlockIdx:-1,searchToBorder:!1,common:s},a=this._Template.Orient.type==G,l=0;s.enableBackwardSearching||s.enableForwardSearching;)s.enableBackwardSearching&&this._DoSearching(o,-l,a),s.enableForwardSearching&&this._DoSearching(r,l,a),l++;if(s.resultStartIdx<0&&(0<=o.latestOverStartLineIdx&&0<=o.firstStartLineBlockIdx?s.resultStartIdx=o.latestOverStartLineIdx:0<=r.firstStartLineBlockIdx&&(s.resultStartIdx=r.firstStartLineBlockIdx)),s.resultEndIdx<0&&(0<=r.latestOverEndLineIdx&&0<=r.firstEndLineBlockIdx?s.resultEndIdx=r.latestOverEndLineIdx:0<=o.firstEndLineBlockIdx&&(s.resultEndIdx=o.firstEndLineBlockIdx)),s.resultStartIdx<0&&s.resultEndIdx<0){var h=this._Template.List[0],u=a?h.yPos:h.xPos,c=this._Template.List[this._Template.List.length-1],d=a?c.yPos:c.xPos,p=a?c.height:c.width;t<u&&d+p<e&&(s.resultStartIdx=0,s.resultEndIdx=this._Template.List.length-1)}var g=null;if(s.resultStartIdx<0&&s.resultEndIdx<0)t<0?0:this._Template.List.length-1;else{var f=0<=s.resultStartIdx?s.resultStartIdx:0,_=0<=s.resultEndIdx?s.resultEndIdx:this._Template.List.length-1;Math.floor((f+_)/2),g={visibleStart:f,visibleEnd:_}}return g}},{key:"_DoSearching",value:function(t,e,i){var n=this._Template.List[t.baseIdx+e],s=i?n.xPos:n.yPos,o=i?n.width:n.height,r=i?n.yPos:n.xPos,a=i?n.height:n.width;if(t.common.resultStartIdx<0&&!t.startLineRangesFulled){var l=!1;if(r<=t.common.checkingStartLinePos&&r+a-1>=t.common.checkingStartLinePos?(t.latestOverStartLineIdx=t.baseIdx+e,t.firstStartLineBlockIdx<0&&(t.firstStartLineBlockIdx=t.baseIdx+e),t.checkingStartLineRanges.Merge(new C(s,s+o-1)),l=!0):t.searchDirect<0&&r+a-1<=t.common.checkingStartLinePos&&(t.checkingStartLineRanges.Merge(new C(s,s+o-1)),l=!0),l)(h=t.checkingStartLineRanges.Ranges[0])&&this.DebugPrint&&h.Start<=0&&h.End>=this._Template.Orient.widthMax-1&&((h.End>this._Template.Orient.widthMax-1||h.Start<0)&&(t.startLineRangesFulled=!0),0<t.searchDirect?t.common.resultStartIdx=t.firstStartLineBlockIdx:t.common.resultStartIdx=t.latestOverStartLineIdx,0<=t.common.resultStartIdx&&(t.common.enableBackwardSearching=!1))}if(t.common.resultEndIdx<0&&!t.endLineRangesFulled){var h;l=!1;if(r<=t.common.checkingEndLinePos&&r+a-1>=t.common.checkingEndLinePos?(t.latestOverEndLineIdx=t.baseIdx+e,t.firstEndLineBlockIdx<0&&(t.firstEndLineBlockIdx=t.baseIdx+e),t.checkingEndLineRanges.Merge(new C(s,s+o-1)),l=!0):0<t.searchDirect&&r>=t.common.checkingEndLinePos&&(t.checkingEndLineRanges.Merge(new C(s,s+o-1)),l=!0),l)(h=t.checkingEndLineRanges.Ranges[0])&&this.DebugPrint&&h.Start<=0&&h.End>=this._Template.Orient.widthMax-1&&((h.End>this._Template.Orient.widthMax-1||h.Start<0)&&(t.endLineRangesFulled=!0),t.searchDirect<0?t.common.resultEndIdx=t.firstEndLineBlockIdx:t.common.resultEndIdx=t.latestOverEndLineIdx,0<=t.common.resultEndIdx&&(t.common.enableForwardSearching=!1))}t.baseIdx+e==t.endSearchingIndex&&(0<t.searchDirect?t.common.enableForwardSearching=!1:t.common.enableBackwardSearching=!1,t.searchToBorder=!0)}}]),o}(),G=Symbol("vertical"),K=Symbol("horizontal"),H=function(){function i(t){var e;return d(this,i),(e=f(this,g(i).call(this,t)))._setVisibility=e._setVisibility.bind(c(e)),e._updateView=e._updateView.bind(c(e)),e.state={visible:!0},e.props.setVisibleFunc&&(e.props.setVisibleFunc(e._setVisibility),e.state.visible=!1),e.props.registerUpdateFunc&&e.props.registerUpdateFunc(e._updateView),e}return l(i,s.Component),e(i,[{key:"_updateView",value:function(){this.setState(this.state)}},{key:"_setVisibility",value:function(t){this.setState({visible:t})}},{key:"render",value:function(){var t=this.state.visible?"visible":"hidden";return s.createElement("div",{style:{left:this.props.x,top:this.props.y,visibility:t}},this.props.renderFunc())}}]),i}(),j=function(){function i(t){var e;return d(this,i),(e=f(this,g(i).call(this,t)))._updateView=e._updateView.bind(c(e)),e.props.registerUpdateFunc(e._updateView),e.state={renderFunc:function(){return null},onRenderDone:V},e}return l(i,s.Component),e(i,[{key:"_updateView",value:function(t,e){this.setState({renderFunc:t,onRenderDone:e||V})}},{key:"render",value:function(){return this.state.renderFunc()}},{key:"componentDidMount",value:function(){this.state.onRenderDone()}},{key:"componentDidUpdate",value:function(){this.state.onRenderDone()}}]),i}(),X=function(){function i(t){var e;return d(this,i),(e=f(this,g(i).call(this,t)))._updateView=e._updateView.bind(c(e)),e.props.registerUpdateFunc(e._updateView),e.state={renderFunc:function(){return null},onRenderDone:V},e}return l(i,s.Component),e(i,[{key:"_updateView",value:function(t,e){this.setState({renderFunc:t,onRenderDone:e||V})}},{key:"render",value:function(){return this.state.renderFunc()}},{key:"componentDidMount",value:function(){this.state.onRenderDone()}},{key:"componentDidUpdate",value:function(){this.state.onRenderDone()}}]),i}(),Y=function(){function i(t){var e;return d(this,i),(e=f(this,g(i).call(this,t)))._updateView=e._updateView.bind(c(e)),e.props.registerUpdateFunc(e._updateView),e.state={renderFunc:function(){return null},onRenderDone:V},e}return l(i,s.Component),e(i,[{key:"_updateView",value:function(t,e){this.setState({renderFunc:t,onRenderDone:e||V})}},{key:"render",value:function(){return this.state.renderFunc()}},{key:"componentDidMount",value:function(){this.state.onRenderDone()}},{key:"componentDidUpdate",value:function(){this.state.onRenderDone()}}]),i}(),W=function(){function t(){return d(this,t),f(this,g(t).apply(this,arguments))}return l(t,s.Component),e(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return s.createElement("div",null,s.createElement(j,{registerUpdateFunc:this.props.registerUpdateContentFunc}),s.createElement(X,{registerUpdateFunc:this.props.registerUpdateFocusFunc}),s.createElement(Y,{registerUpdateFunc:this.props.registerUpdateBlurFunc}))}}]),t}(),z=function(){function i(t){var e;return d(this,i),(e=f(this,g(i).call(this,t)))._updateView=e._updateView.bind(c(e)),e.props.registerUpdateFunc(e._updateView),e.state={x:0,y:0,transition:"",transitionCallback:V},e}return l(i,s.Component),e(i,[{key:"_updateView",value:function(t,e,i,n){this.setState({x:t,y:e,transition:i,transitionCallback:n})}},{key:"render",value:function(){return s.createElement("div",{style:{left:this.props.x,top:this.props.y}},s.createElement("div",{style:{transition:this.state.transition,top:this.state.y,left:this.state.x},onTransitionEnd:this.state.transitionCallback},s.createElement(W,{registerUpdateContentFunc:this.props.registerUpdateContentFunc,registerUpdateFocusFunc:this.props.registerUpdateFocusFunc,registerUpdateBlurFunc:this.props.registerUpdateBlurFunc})))}}]),i}(),J=function(){function p(t){var i;d(this,p),i=f(this,g(p).call(this,t)),console.log("SimpleWidget constructor."),i._OnKeyDown=i._OnKeyDown.bind(c(i)),i._onFocusInner=i._onFocusInner.bind(c(i)),i._onBlurInner=i._onBlurInner.bind(c(i)),i._OnFocusableItemEdge=i._OnFocusableItemEdge.bind(c(i)),i._updateItemVisibility=i._updateItemVisibility.bind(c(i)),i._onTransitionEnd=i._onTransitionEnd.bind(c(i)),i._getContentView=i._getContentView.bind(c(i)),i._getFocusView=i._getFocusView.bind(c(i)),i._getBlurView=i._getBlurView.bind(c(i)),i._onContentUpdate=i._onContentUpdate.bind(c(i)),i._drawItem=i._drawItem.bind(c(i)),i._getSlideAnim=i._getSlideAnim.bind(c(i)),i._setItmeVisible=i._setItmeVisible.bind(c(i)),i._updateFocusItem=i._updateFocusItem.bind(c(i)),i._AllState={},i._AllState.isFocus=!1;var e=p._getTemplateParser(i.props);p._AddTemplateItem(i.props,e,0),i._AllState.templateParser=e,i._VisibleItemList=[],i._NeedHideItemList=[],i._ItemVisibleFuncMap=[],i._registerItemVisibleFunc=function(e){return function(t){i._ItemVisibleFuncMap[e]={visible:!1,func:t}}},i._focusableItemUpdateFuncMap=new Map,i._registerFocusableItemUpdateFunc=function(e){return function(t){i._focusableItemUpdateFuncMap.set(e,t)}},i._updateRootFunc=V,i._registerUpdateRootFunc=function(t){i._updateRootFunc=t},i._updateContentFunc=V,i._registerUpdateContentFunc=function(t){i._updateContentFunc=t},i._updateFocusFunc=V,i._registerUpdateFocusFunc=function(t){i._updateFocusFunc=t},i._updateBlurFunc=V,i._registerUpdateBlurFunc=function(t){i._updateBlurFunc=t};var n=0,s=0,o=i.props.direction===G?i.props.height:i.props.width;if(i._VisibleItemList=i._getVisibleItemList(n,s,s+o-1),void 0!==i.props.baseAnchor){var r=i._BaseAnchorInfo2Pos(i.props.baseAnchor,0,o);s=i.props.direction===G?r.yPos:r.xPos,i._VisibleItemList=i._getVisibleItemList(i.props.baseAnchor.id,s,s+o-1)}return i.props.enterFocusId?(n=i.props.enterFocusId,void 0===i.props.baseAnchor&&(s=i._CalculateSlide(i._AllState.templateParser.GetItem(n),1,0),i._VisibleItemList=i._getVisibleItemList(n,s,s+o-1))):i._ifValidEnterRect(i.props.enterRect)&&(n=i._calculateNearestItemByRect(i._VisibleItemList,i.props.enterRect)),i._AllState.focusId=n,i._AllState.preFocusId=-1,i._AllState.preEdgeRect=null,i._AllState.visibleStart=s,i._AllState.visibleRange=o,i._AllState.baseAnchor=i.props.baseAnchor,i}return l(p,s.Component),e(p,[{key:"_getSlideAnim",value:function(){var t=void 0===this.props.slideTime?.2:this.props.slideTime;return"left "+t+"s, top "+t+"s"}},{key:"_getVisibleItemList",value:function(t,e,i){var n=this._AllState.templateParser.GetVisibleItemList(e,i,t);return this._AllState.templateParser.GetTemplate().List.slice(n.visibleStart,n.visibleEnd+1)}},{key:"_calculateNearestItemByRect",value:function(t,e){var i=e.direction,n=e.rect,s="",o={x:0,y:0};switch(i){case Z.left:s="left",o.x=n.x,o.y=n.y+n.height/4;break;case Z.right:s="right",o.x=n.x+n.width,o.y=n.y+n.height/4;break;case Z.top:s="up",o.x=n.x+n.width/4,o.y=n.y;break;case Z.bottom:s="down",o.x=n.x+n.width/4,o.y=n.y+n.height}var r=new C(o.x,o.x),a=new C(o.y,o.y),l=null,h=-1,u=0,c=0,d=0,p=this.props.direction==G?"yPos":"xPos",g=this.props.direction==G?"height":"width",f=!0,_=!1,m=void 0;try{for(var y,b=t[Symbol.iterator]();!(f=(y=b.next()).done);f=!0){var v=y.value;if(v[p]>=this._AllState.visibleStart&&v[p]+v[g]-1<=this._AllState.visibleStart+this._AllState.visibleRange-1){var I=this.props.direction==G?v.xPos:v.xPos-this._AllState.visibleStart,S=this.props.direction==G?v.yPos-this._AllState.visibleStart:v.yPos,x=new C(I,I+v.width-1),F=new C(S,S+v.height-1);switch(s){case"left":if(o.x<I+v.width-1)continue;o.y<S?c=Math.pow(o.x-(I+v.width-1),2)+Math.pow(S-o.y,2):a.IsInterAct(F)?c=Math.pow(o.x-(I+v.width-1),2):o.y>S+v.height-1&&(c=Math.pow(o.x-(I+v.width-1),2)+Math.pow(o.y-(S+v.height-1),2)),d=Math.abs(o.x-(I+v.width-1));break;case"right":if(o.x>I)continue;o.y<S?c=Math.pow(I-o.x,2)+Math.pow(S-o.y,2):a.IsInterAct(F)?c=Math.pow(I-o.x,2):o.y>S+v.height-1&&(c=Math.pow(I-o.x,2)+Math.pow(o.y-(S+v.height-1),2)),d=Math.abs(o.x-I);break;case"up":if(o.y<S+v.height-1)continue;o.x<I?c=Math.pow(o.x-I,2)+Math.pow(o.y-(S+v.height-1),2):r.IsInterAct(x)?c=Math.pow(o.y-(S+v.height-1),2):o.x>I+v.width-1&&(c=Math.pow(o.x-(I+v.width-1),2)+Math.pow(o.y-(S+v.height-1),2)),d=Math.abs(o.y-(S+v.height-1));break;case"down":if(o.y>S)continue;o.x<I?c=Math.pow(o.x-I,2)+Math.pow(S-o.y,2):r.IsInterAct(x)?c=Math.pow(S-o.y,2):o.x>I+v.width-1&&(c=Math.pow(o.x-(I+v.width-1),2)+Math.pow(S-o.y,2)),d=Math.abs(o.y-S);break;default:console.log("direction is error:"+s)}h<0?(h=c,u=d,l=v):(d<u||u==d&&c<h)&&(h=c,u=d,l=v)}}}catch(t){_=!0,m=t}finally{try{f||null==b.return||b.return()}finally{if(_)throw m}}return l?l.id:0}},{key:"_updateItemVisibility",value:function(t,e){for(var i=this._AllState.templateParser.GetTemplate(),n=0;n<t.length;++n){var s=this._ItemVisibleFuncMap[i.IdsMap[t[n].id]];s&&s.visible!=e&&(s.visible=e,s.func&&s.func(e))}}},{key:"_OnKeyDown",value:function(t){var e=0,i=0;switch(t.keyCode){case 37:e=-1;break;case 38:i=-1;break;case 39:e=1;break;case 40:i=1;break;case 13:var n=this._AllState.templateParser.GetItem(this._AllState.focusId);!n.itemFocusable&&this.props.onClick&&this.props.onClick(n.data);break;default:return!1}return this._moveToNext(e,i),!0}},{key:"_moveToNext",value:function(t,e,i){var n=this._AllState.templateParser.GetTemplate(),s=this._AllState.preFocusId,o=n.IdsMap[this._AllState.focusId],r=void 0!==this.props.loopFocus&&this.props.loopFocus,a=this._AllState.templateParser.GetNextItem(o,e,t,r);if(0<=a){this._AllState.preFocusId=this._AllState.focusId;var l=this._AllState.templateParser.GetItem(a);this._AllState.focusId=l.id;var h=this.props.direction==G?e:t,u=this._AllState.visibleStart,c=this._CalculateSlide(n.List[a],h,this._AllState.visibleStart);if(u!=c){var d=this._VisibleItemList;this._VisibleItemList=this._getVisibleItemList(a,c,c+this._AllState.visibleRange-1);var p=!0,g=!1,f=void 0;try{for(var _,m=d[Symbol.iterator]();!(p=(_=m.next()).done);p=!0){var y=_.value;this._VisibleItemList.indexOf(y)<0&&this._NeedHideItemList.indexOf(y)<0&&this._NeedHideItemList.push(y)}}catch(t){g=!0,f=t}finally{try{p||null==m.return||m.return()}finally{if(g)throw f}}var b=!0,v=!1,I=void 0;try{for(var S,x=this._VisibleItemList[Symbol.iterator]();!(b=(S=x.next()).done);b=!0){var F=S.value,k=this._NeedHideItemList.indexOf(F);0<=k&&this._NeedHideItemList.splice(k,1)}}catch(t){v=!0,I=t}finally{try{b||null==x.return||x.return()}finally{if(v)throw I}}this._AllState.visibleStart=c,this._updateItemVisibility(this._VisibleItemList,!0);var L=this.props.direction==G?0:-this._AllState.visibleStart,w=this.props.direction==G?-this._AllState.visibleStart:0;this._updateRootFunc(L,w,this._getSlideAnim(),this._onTransitionEnd)}if(l.itemFocusable){var E,P=n.List[o].xPos-n.List[a].xPos,A=n.List[o].yPos-n.List[a].yPos;if(E=i?(i.rect.x+=P,i.rect.y+=A,i):{direction:null,rect:{x:P,y:A,width:n.List[o].width,height:n.List[o].height}},this._AllState.preEdgeRect=E,0<=this._AllState.preFocusId&&this.props.onItemBlur){var O=this._AllState.templateParser.GetTemplate();this.props.onItemBlur(O.List[O.IdsMap[this._AllState.preFocusId]])}this._focusableItemUpdateFuncMap.has(a)&&this._focusableItemUpdateFuncMap.get(a)()}else s!=this._AllState.preFocusId&&this._setItmeVisible(n.IdsMap[s],!0),this._updateFocusItem(),this._updateBlurItem();this._AllState.isFocus&&this.props.onItemFocus&&this.props.onItemFocus(l.data)}else if(this.props.onEdge){var N,R=this.props.direction==G?0:this._AllState.visibleStart,C=this.props.direction==G?this._AllState.visibleStart:0;1==t&&(N=Z.right),-1==t&&(N=Z.left),1==e&&(N=Z.bottom),-1==e&&(N=Z.top);var T={x:n.List[o].xPos-R,y:n.List[o].yPos-C,width:n.List[o].width,height:n.List[o].height};this.props.onEdge({direction:N,rect:T})}}},{key:"_CalculateSlide",value:function(t,e,i){var n=i,s=n,o=this._AllState.templateParser.GetTemplate().List,r=o[o.length-1],a=this.props.direction==G?"yPos":"xPos",l=this.props.direction==G?"height":"width",h=this.props.direction===G?"bottom":"right",u=this.props.direction==G?this.props.height:this.props.width;switch(void 0!==this.props.slideStyle?this.props.slideStyle:q.seamLess){case q.seamLess:var c=r[a]+r[l]-u+p._getPadding(this.props)[h];0<e?t[a]+t[l]>n+4*u/5&&(s=t[a]+t[l]-4*u/5):e<0&&t[a]<n+u/5&&(s=t[a]-u/5),s=(s=c<s?c:s)<0?0:s;break;case q.wholePage:0<e?t[a]+t[l]>n+u+1&&(s=t[a]):e<0&&t[a]<n&&(s=(s=t[a]+t[l]-u)<0?0:s)}return s}},{key:"_OnFocusableItemEdge",value:function(t){var e=0,i=0;switch(t.direction){case Z.left:e=-1;break;case Z.right:e=1;break;case Z.top:i=-1;break;case Z.bottom:i=1}this._moveToNext(e,i,t)}},{key:"_ifValidEnterRect",value:function(t){return t&&t.direction&&t.rect}},{key:"_setItmeVisible",value:function(t,e){var i=this._ItemVisibleFuncMap[t];i&&i.visible!=e&&(i.visible=e,i.func&&i.func(e))}},{key:"_onFocusInner",value:function(){var t=void 0!==this.props.enterFocusId?this.props.enterFocusId:this._AllState.focusId;t=this._ifValidEnterRect(this.props.enterRect)?this._calculateNearestItemByRect(this._VisibleItemList,this.props.enterRect):t,this._AllState.isFocus=!0,this._AllState.focusId=t,this._setItmeVisible(this._AllState.templateParser.GetTemplate().IdsMap[this._AllState.preFocusId],!0),this._AllState.preFocusId=-1,this._updateFocusItem(),this._updateBlurFunc(this._getBlurView),this.props.onItemFocus&&this.props.onItemFocus(this._AllState.templateParser.GetItem(t)),this.props.onFocus&&this.props.onFocus()}},{key:"_onBlurInner",value:function(){this._AllState.isFocus=!1,this._setItmeVisible(this._AllState.templateParser.GetTemplate().IdsMap[this._AllState.preFocusId],!0),this._AllState.preFocusId=this._AllState.focusId,this._updateFocusFunc(this._getFocusView),this._updateBlurItem(),this.props.onBlur&&this.props.onBlur()}},{key:"_onTransitionEnd",value:function(t){t.stopPropagation(),this._updateItemVisibility(this._NeedHideItemList,!1),this._NeedHideItemList=[]}},{key:"_drawItem",value:function(t){var e=this;return function(){return e.props.renderItem(t.data,e._OnFocusableItemEdge,e._AllState.preEdgeRect)}}},{key:"_getContentView",value:function(){var n=this,t=this._AllState.templateParser.GetTemplate().List;return s.createElement("div",{id:"container"},t.map(function(t,e){var i=null;return t.itemFocusable&&(i=n._registerFocusableItemUpdateFunc(e)),s.createElement(H,{key:t.id,x:t.xPos,y:t.yPos,setVisibleFunc:n._registerItemVisibleFunc(e),registerUpdateFunc:i,renderFunc:n._drawItem(t)})}))}},{key:"_onContentUpdate",value:function(){this._updateItemVisibility(this._VisibleItemList,!0);var t=this._AllState.templateParser.GetItem(this._AllState.focusId);if(t.itemFocusable&&(this._AllState.isFocus&&this.props.onItemFocus&&this.props.onItemFocus(t.data),0<=this._AllState.preFocusId&&this.props.onItemBlur)){var e=this._AllState.templateParser.GetTemplate();this.props.onItemBlur(e.List[e.IdsMap[this._AllState.preFocusId]])}this._updateFocusItem()}},{key:"_drawFocusItem",value:function(t){var e=this;return function(){return e.props.renderFocus(t.data)}}},{key:"_getFocusView",value:function(){var t=this._AllState.templateParser.GetItem(this._AllState.focusId);return t&&!t.itemFocusable&&this._AllState.isFocus&&this.props.renderFocus?s.createElement(H,{key:t.id,x:t.xPos,y:t.yPos,renderFunc:this._drawFocusItem(t)}):null}},{key:"_updateFocusItem",value:function(){this._updateFocusFunc(this._getFocusView);var t=this._AllState.templateParser.GetItem(this._AllState.focusId);t&&!t.itemFocusable&&this._AllState.isFocus&&this.props.renderFocus&&this._setItmeVisible(this._AllState.templateParser.GetTemplate().IdsMap[this._AllState.focusId],!1)}},{key:"_drawBlurItem",value:function(t){var e=this;return function(){return e.props.renderBlur(t.data,e._renderBlurEndCallback(t.id))}}},{key:"_getBlurView",value:function(){var t=this._AllState.templateParser.GetItem(this._AllState.preFocusId);return t&&!t.itemFocusable&&this.props.renderBlur?s.createElement(H,{key:t.id,x:t.xPos,y:t.yPos,renderFunc:this._drawBlurItem(t)}):null}},{key:"_updateBlurItem",value:function(){this._updateBlurFunc(this._getBlurView);var t=this._AllState.templateParser.GetItem(this._AllState.preFocusId);t&&!t.itemFocusable&&this.props.renderBlur||this._setItmeVisible(this._AllState.templateParser.GetTemplate().IdsMap[this._AllState.preFocusId],!0)}},{key:"_onFocusUpdate",value:function(){}},{key:"_BaseAnchorInfo2Pos",value:function(t,e,i){var n=t.id,s={xPos:this.props.direction===G?0:e,yPos:this.props.direction===G?e:0};if(void 0!==n&&null!=n){var o=this._AllState.templateParser.GetTemplate().List,r=o[n],a=o[o.length-1];if(r){var l=void 0!==t.type?t.type:"start",h=this.props.direction===G?"yPos":"xPos",u=this.props.direction===G?"height":"width",c=this.props.direction===G?"bottom":"right";switch(l){case"start":s[h]=r[h];break;case"center":s[h]=r[h]-i/2+r[u]/2;break;case"end":s[h]=r[h]+r[u]-1-i}var d=a[h]+a[u]-i+p._getPadding(this.props)[c]-1;s[h]=s[h]>d?d:s[h],s[h]=s[h]<0?0:s[h]}}return s}},{key:"_slideViewToAnchor",value:function(t){var e=this._BaseAnchorInfo2Pos(t,this._AllState.visibleStart,this._AllState.visibleRange);this._AllState.visibleStart=this.props.direction===G?e.yPos:e.xPos;var i=this._VisibleItemList;this._VisibleItemList=this._getVisibleItemList(t.id,this._AllState.visibleStart,this._AllState.visibleStart+this._AllState.visibleRange-1);var n=!0,s=!1,o=void 0;try{for(var r,a=i[Symbol.iterator]();!(n=(r=a.next()).done);n=!0){var l=r.value;this._VisibleItemList.indexOf(l)<0&&this._NeedHideItemList.indexOf(l)<0&&this._NeedHideItemList.push(l)}}catch(t){s=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(s)throw o}}this._updateItemVisibility(this._VisibleItemList,!0),this._updateRootFunc(-e.xPos,-e.yPos,this._getSlideAnim(),this._onTransitionEnd)}},{key:"_onBlurUpdate",value:function(){}},{key:"_renderBlurEndCallback",value:function(t){var e=this;return function(){t==e._AllState.preFocusId&&e._updateBlurFunc(U),e._setItmeVisible(e._AllState.templateParser.GetTemplate().IdsMap[t],!0)}}},{key:"render",value:function(){return s.createElement(O,{onKeyDown:this._OnKeyDown,branchName:this.props.branchName,onFocus:this._onFocusInner,onBlur:this._onBlurInner,style:a({},this.props.style,{clipPath:"inset(0px 0px 0px 0px)",width:this.props.width,height:this.props.height})},s.createElement(z,{x:this.props.padding&&void 0!==this.props.padding.left?this.props.padding.left:0,y:this.props.padding&&void 0!==this.props.padding.top?this.props.padding.top:0,registerUpdateFunc:this._registerUpdateRootFunc,registerUpdateContentFunc:this._registerUpdateContentFunc,registerUpdateFocusFunc:this._registerUpdateFocusFunc,registerUpdateBlurFunc:this._registerUpdateBlurFunc}))}},{key:"componentDidUpdate",value:function(){var t=this._AllState.templateParser.GetTemplate().List,e=this.props.data,i=0;for(i=0;i<e.length;++i){for(var n=!1,s=0;s<t.length;++s)if(e[i]===t[s].data){n=!0;break}if(!n)break}var o=!1;if(i===t.length)i!==e.length?(o=!0,p._AddTemplateItem(this.props,this._AllState.templateParser,i)):!this.props.baseAnchor||this.props.baseAnchor.id==this._AllState.baseAnchor.id&&this.props.baseAnchor.type==this._AllState.baseAnchor.type||(this._AllState.baseAnchor=this.props.baseAnchor,this._slideViewToAnchor(this._AllState.baseAnchor));else{o=!0;var r=p._getTemplateParser(this.props);p._AddTemplateItem(this.props,r,0),this._AllState.templateParser=r}o&&this._updateContentFunc(this._getContentView,null),this._AllState.focusId>=this.props.data.length&&(this._AllState.focusId=0,this._AllState.preFocusId=-1,0!=this._AllState.visibleStart&&(this._AllState.visibleStart=0,this._updateRootFunc(0,0,"",null)),this._updateFocusItem())}},{key:"componentDidMount",value:function(){if(this._updateContentFunc(this._getContentView,this._onContentUpdate),0!==this._AllState.visibleStart){var t=this.props.direction==G?0:-this._AllState.visibleStart,e=this.props.direction==G?-this._AllState.visibleStart:0;this._updateRootFunc(t,e,"",null)}}}],[{key:"_getPadding",value:function(t){var e={left:0,right:0,top:0,bottom:0};return void 0!==t.padding&&null!=t.padding&&(e={left:void 0===t.padding.left?0:t.padding.left,right:void 0===t.padding.right?0:t.padding.right,top:void 0===t.padding.top?0:t.padding.top,bottom:void 0===t.padding.bottom?0:t.padding.bottom}),e}},{key:"_getTemplateParser",value:function(t){var e=p._getPadding(t),i=t.direction==G?t.width-e.left-e.right:t.height-e.top-e.bottom,n=t.layoutType?t.layoutType:"relative";return new B(t.direction,i,n,t.width,t.height)}},{key:"_AddTemplateItem",value:function(t,e,i){for(var n=i;n<t.data.length;n++){var s=t.measures(t.data[n]);e.ParseTemplateItem(s,t.data[n])}e.CalculateNeighborWhenAddStop()}}]),p}(),q={seamLess:Symbol("seamless"),wholePage:Symbol("wholePage"),seamlessFixedId:Symbol("seamlessFixedId")},Z={left:Symbol("left"),right:Symbol("right"),top:Symbol("top"),bottom:Symbol("bottom")};t.EdgeDirection=Z,t.Fdiv=O,t.FdivRoot=N,t.HROIZONTAL=K,t.Router=F,t.SimpleWidget=J,t.SlideStyle=q,t.VERTICAL=G,Object.defineProperty(t,"__esModule",{value:!0})});
